<!Doctype HTML>
<html lang="en">
  
  <head>
  <meta charset="utf-8">
  <script id="lib-script" src = "https://cdn.rawgit.com/GoodBoyDigital/pixi.js/dev/bin/pixi.js"></script>
  <script type ="text/javascript" src="/socket.io/socket.io.js"></script>
  <!--<script src="Player.js"></script>-->

  </head>
  <body>

  <script src="matter.js" type="text/javascript"></script>
  <script src="GameObjectManager.js"></script>
  <script src="GameObject.js"></script>
  <script src="Character.js"></script>
  <script src="Item.js"></script>
  <!--<script src="Game.js"></script>-->
  <script src="PlayerManager.js"></script>
  <!--<script src="PoPGame.js"></script>-->
  <script src="InputListener.js"></script>
  <script src="Client/ClientGame.js"></script>
     <script type ="text/javascript">
	    var game={};
	    game = new Game(60);
	    var socket = io();
	    
	    socket.on('connect', function(){
	      socket.emit('join');
	    });
	    
	    game.socket=socket;
	    //Start game.
	    socket.on('start', function(data){
	      if(game.id==data){
		game.start();
		console.log('Start game ' +data);
	      }
	    });
	    
	    //Client on move call updatePlayerPosition
	    socket.on('move', function(data){
	      game.updatePlayerPosition(data);
	      if(data.attack == true){
	        game.attack(data);
	      }

	     });
	    
	    //CreatePlayer
	    socket.on('createPlayer', function(data){
	      game.id=data.Player.gameid;
	      console.log('From createPlayer Client gameid: '+data.Player.gameid);
	      game.addLocalPlayer(data);
	    });
	    
	    //Add other players when they connect
	    socket.on('addOtherPlayer', function(data){
	      if(game.id==data.Player.gameid){
		if(game.localPlayerid!=data.Player.id){
		  console.log('From addOtherPlayer');
		  console.log('Adding player: ' +data.Player.id);
		  game.addOtherPlayer(data);
	      	}
	      }
	    });
	    
	    //Remove other players as they leave.
	    socket.on('removeOtherPlayer', function(data){
	      if(game.id==data.Player.gameid){
		game.removeOtherPlayer(data);
	      }
	    });
	    socket.on('RequestOldPlayer', function(data){
	      console.log('From RequestOldPlayer');
	      if(game.id==data.Player.gameid){
		console.log('Adding player: ' + data.Player.id);
		game.addOtherPlayer(data);
	      }
	    });
    </script>
  </body>
</html>
